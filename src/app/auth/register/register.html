<div class="register-wrapper bg-light d-flex justify-content-center align-items-center">
  <div class="card mat-elevation-z8 p-4 register-card">

    <!-- Logo + App Name -->
    <div class="text-center mb-4 mt-2">
      <div class="d-flex justify-content-center align-items-center mb-2">
        <i class="fas fa-cube fa-2x me-2 text-primary"></i>
        <h3 class="m-0 fw-bold text-primary">Eduflow</h3>
      </div>
      <p class="text-muted mb-0">Create your Eduflow account</p>
    </div>

    <mat-card-content>
      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="w-100">

        <!-- First Name -->
        <mat-form-field appearance="outline" class="w-100 mb-3">
          <mat-label>First Name</mat-label>
          <input matInput type="text" formControlName="firstName" placeholder="Enter first name" />
          @if (registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched) {
            <mat-error>First name is required</mat-error>
          }
        </mat-form-field>

        <!-- Last Name -->
        <mat-form-field appearance="outline" class="w-100 mb-3">
          <mat-label>Last Name</mat-label>
          <input matInput type="text" formControlName="lastName" placeholder="Enter last name" />
          @if (registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched) {
            <mat-error>Last name is required</mat-error>
          }
        </mat-form-field>

        <!-- Email -->
        <mat-form-field appearance="outline" class="w-100 mb-3">
          <mat-label>Email</mat-label>
          <input matInput type="email" formControlName="email" placeholder="Enter email" />
          <mat-icon matSuffix>mail</mat-icon>
          @if (registerForm.get('email')?.invalid && registerForm.get('email')?.touched) {
            <mat-error>Valid email is required</mat-error>
          }
        </mat-form-field>

        <!-- Phone -->
        <mat-form-field appearance="outline" class="w-100 mb-3">
          <mat-label>Phone</mat-label>
          <input matInput type="tel" formControlName="phone" placeholder="Enter phone number" />
          <mat-icon matSuffix>phone</mat-icon>
          @if (registerForm.get('phone')?.invalid && registerForm.get('phone')?.touched) {
            <mat-error>Phone number is required</mat-error>
          }
        </mat-form-field>

        <!-- Date of Birth -->
        <mat-form-field appearance="outline" class="w-100 mb-3">
          <mat-label>Date of Birth</mat-label>
          <input matInput type="date" formControlName="dob" />
          @if (registerForm.get('dob')?.invalid && registerForm.get('dob')?.touched) {
            <mat-error>Date of birth is required</mat-error>
          }
        </mat-form-field>

        <!-- Password -->
        <mat-form-field appearance="outline" class="w-100 mb-3">
          <mat-label>Password</mat-label>
          <input
            matInput
            [type]="hide ? 'password' : 'text'"
            formControlName="password"
            placeholder="Enter password"
          />
          <button mat-icon-button matSuffix type="button" (click)="hide = !hide">
            <mat-icon>{{ hide ? 'visibility_off' : 'visibility' }}</mat-icon>
          </button>
          @if (registerForm.get('password')?.invalid && registerForm.get('password')?.touched) {
            <mat-error>Password is required</mat-error>
          }
        </mat-form-field>

        <!-- Confirm Password -->
        <mat-form-field appearance="outline" class="w-100 mb-3">
          <mat-label>Confirm Password</mat-label>
          <input
            matInput
            [type]="hideConfirm ? 'password' : 'text'"
            formControlName="confirmPassword"
            placeholder="Confirm password"
          />
          <button mat-icon-button matSuffix type="button" (click)="hideConfirm = !hideConfirm">
            <mat-icon>{{ hideConfirm ? 'visibility_off' : 'visibility' }}</mat-icon>
          </button>
          @if (registerForm.hasError('passwordsMismatch') && registerForm.get('confirmPassword')?.touched) {
            <mat-error>Passwords must match</mat-error>
          }
          @if (registerForm.get('confirmPassword')?.hasError('required')) {
            <mat-error>Confirm password is required</mat-error>
          }
        </mat-form-field>

        <!-- User Role -->
        <div class="mb-3">
          <label class="fw-semibold mb-2 d-block">Select Role</label>
          <div class="d-flex gap-3">
            <mat-checkbox
              [checked]="registerForm.get('role')?.value === 'STUDENT'"
              (change)="registerForm.get('role')?.setValue('STUDENT')"
            >
              Student
            </mat-checkbox>

            <mat-checkbox
              [checked]="registerForm.get('role')?.value === 'INSTRUCTOR'"
              (change)="registerForm.get('role')?.setValue('INSTRUCTOR')"
            >
              Instructor
            </mat-checkbox>
          </div>
          @if (registerForm.get('role')?.invalid && registerForm.get('role')?.touched) {
            <mat-error>Role is required</mat-error>
          }
        </div>

        <!-- Submit Button -->
        <button
          mat-raised-button
          color="primary"
          class="w-100 mt-2 py-2 fw-semibold"
          [disabled]="registerForm.invalid || isLoading"
        >
          @if (isLoading) {
            <span class="d-flex align-items-center justify-content-center">
              <mat-spinner diameter="18" class="me-2"></mat-spinner>
              Registering...
            </span>
          } @else {
            Register
          }
        </button>
       
      </form>
    </mat-card-content>

    <!-- Login Link -->
    <mat-card-actions class="text-center mt-3 d-flex flex-column">
      <a mat-button routerLink="/auth/login" class="text-primary mb-2">
        Already have an account? <strong>Sign In</strong>
      </a>
    </mat-card-actions>
  </div>
</div>
